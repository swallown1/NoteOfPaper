## Neural Graph Collaborative Filtering  (图神经协同过滤)


>论文链接：[Neural Graph Collaborative Filtering](https://arxiv.org/abs/1905.08108?context=cs.IR)

>原理：在user-item interaction graph 上使用GCN 来学习高阶连通中的协同因子，将其嵌入到user和item的向量表示上，然后模型通过内积的方式进行相互建模。

>与其他使用GNN处理的区别：

>1. 大部分使用GNN进行处理的论文，只学习User向量，这篇中item也是使用GNN进行学习

>2. 大部分论文是在知识图谱KG或者社交网络Social Network上使用GNN，这篇论文是在用户-项交互二部图上使用GNN

在讲NGCF之前，先说说相关概念

#### CF中关键方法：

- 嵌入: 将user 和 item转化为矢量化表示

- 交互建模：重建历史嵌入的模型，例如，矩阵因式分解(MF)直接嵌入用户/项ID作为向量，并建立用户-项与内积交互的模。

>#### 背景:
>- 协同过滤学习模型从项目的丰富侧面信息中学习的深层表示来扩展MF嵌入功能；
>- 神经协同过滤模型则用非线性神经网络取代内积的MF交互函数。

>以上的方法在交互建模中都是有效的，但是却无法为CF提供更好的嵌入表示，因为缺少一个协同信号（它潜伏在用户与项目之间的交互>中，以揭示用户(或项目)之间的行为相似性。）更具体的是，现有的大多数方法只使用描述性的特性(例如id和属性)构建嵌入功能，而不考虑用户-项的交互-这些功能只用于定义模型训练的目标函数。因此必须依赖交互功能弥补次优嵌入的不足。虽然直接地使用交互功能能弥补次优嵌入的不足，但是在实际开发中，交互的规模可以容易地达到数百万甚至更大，使得难以提取期望的协作信号。所以在这项工作中，我们解决了所有问题，通过利用来自用户项目交互的高阶连通性，在交互图形结构中对协作信号进行编码的方式。

#### 高阶连通性

![figure 1](https://upload-images.jianshu.io/upload_images/9137004-bde5ab3500c66771.png?imageMogr2/auto-orient/strip|imageView2/2/w/940/format/webp)

图1左边所示的为协同过滤用户-项目交互的基本交互图，双圆圈表示需要预测的用户u1，右图为左图以用户u1为根节点扩展的树形结构，l为到达用户u1的路径长度（可以作为兴趣重要度的权重值）
从右图中可以看到，同路径长度为3的项目i4、i5中，明显用户对i4的兴趣度高于i5，这是因为<i4,u1>连接的路径有两条，分别为i4->u2->i2->u1、i4->u3->i3->u1，而<i5,u1>则只有一条，为i5->u2->i2->u1。所以通过这些树形结构来查看u1对项目的兴趣，看项目与用户的连通性。这就是高阶连通性的概念。

#### 优化点：

- 在最近的名为Hop-Rec的方法中已经考虑了高阶连通性信息，但是它只是用于丰富训练数据，具体来说HOPRec的预测模型仍然是MF，而它是通过优化具有高阶连通性的亏损来训练的。

- 而NGCF则不同，这是一种将高阶连通性集成到预测模型中的新技术，该技术在经验上比Cf的HOP-Rec具有更好的嵌入效果。


### NGCF模型 

#### 1. 摘要

本文作者认为现有的工作通常通过从描述用户(或项目)的现有特性(如ID和属性)映射来获得用户(或项目)的嵌入。但是这种方法的一个固有缺点是，隐藏在**用户-项目交互中的协作信号**没有在嵌入过程中编码。因此，由此产生的嵌入可能不足以捕获协作过滤效果。

而在这项工作中，将用户-项目交互更具体地集成到嵌入过程中**二部图结构**。提出了一种新的推荐框架神经图协同过滤算法(NGCF)，**该算法利用用户项图的结构，在用户项图上传播嵌入**。这就导致了用户项图中高阶连通性的表达建模，有效地将协作信号显式地注入到嵌入过程中。


### 2.模型结构

**模型主要包括以下结构：**

1. 嵌入层：给模型提供初始的嵌入向量，包括用户嵌入和项嵌入。

2. 嵌入传播层：通过多个嵌入传播层学习高阶连通性中的协同因子，编码进用户和项的表示。

3. 预测层：将来自不同传播层的精化嵌入集合起来，并通过内积模拟交互，输出用户-项对的亲和力分数。

####　2.1嵌入层
初始化用户和项目交互的数据,建立参数矩阵.
将用户和相互初始化为以下格式：

![embedding](https://github.com/swallown1/NoteOfPaper/blob/master/SIGIR/NGCF/image/embedding.jpg)

**优化点：**

这种端到端的优化，传统的神经协同和MF都是直接输入数据到交互层(或操作符)以达到预测分数。相反，在NGCF框架中，通过在用户项交互图上传播嵌入来改进嵌入。因为嵌入细化步骤明确地将协同信号注入到嵌入中。

####　2.2嵌入传播层：
